# Modal 模态窗组件

## 概述

`Modal` 是一个完全符合主题系统的通用模态窗组件，支持动态样式绑定、多种尺寸、自定义插槽等功能。

## 基本用法

```vue
<script setup lang="ts">
import { ref } from 'vue'
import Modal from '@/components/Modal.vue'

const showModal = ref(false)

const handleConfirm = () => {
  console.log('确认操作')
  showModal.value = false
}

const handleCancel = () => {
  console.log('取消操作')
}
</script>

<template>
  <button @click="showModal = true">打开模态窗</button>
  
  <Modal
    v-model="showModal"
    title="标题"
    @confirm="handleConfirm"
    @cancel="handleCancel"
  >
    <p>这是模态窗的内容</p>
  </Modal>
</template>
```

## Props

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `modelValue` | `boolean` | - | 控制模态窗显示/隐藏（v-model） |
| `title` | `string` | - | 模态窗标题 |
| `size` | `'small' \| 'medium' \| 'large' \| 'xlarge'` | `'medium'` | 模态窗尺寸 |
| `showFooter` | `boolean` | `true` | 是否显示底部按钮区域 |
| `confirmText` | `string` | `'确定'` | 确认按钮文本 |
| `cancelText` | `string` | `'取消'` | 取消按钮文本 |
| `confirmLoading` | `boolean` | `false` | 确认按钮加载状态 |
| `closeOnClickOutside` | `boolean` | `true` | 点击遮罩层是否关闭模态窗 |

## Events

| 事件名 | 参数 | 说明 |
|--------|------|------|
| `update:modelValue` | `(value: boolean)` | 模态窗显示状态变化时触发 |
| `confirm` | - | 点击确认按钮时触发 |
| `cancel` | - | 点击取消按钮时触发 |
| `close` | - | 模态窗关闭时触发 |

## 插槽

| 插槽名 | 说明 |
|--------|------|
| `default` | 模态窗主体内容 |
| `header` | 自定义头部内容（替换默认标题） |
| `footer` | 自定义底部内容（替换默认按钮） |

## 尺寸说明

- `small`: 最大宽度 400px
- `medium`: 最大宽度 600px（默认）
- `large`: 最大宽度 800px
- `xlarge`: 最大宽度 1000px

## 主题变量

模态窗组件**完全绑定到主题系统**，所有样式都通过 CSS 变量控制，可在"组件画廊 > 模态窗"中实时配置和预览。

### 遮罩层
- `--modal-overlay-color`: 遮罩层背景色（默认 `rgba(0, 0, 0, 0.5)`）
- `--modal-overlay-opacity`: 遮罩层透明度（默认 `1`）
- `--modal-overlay-blur`: 遮罩层模糊度（默认 `4px`）

### 容器
- `--modal-bg-color`: 模态窗背景色
- `--modal-radius`: 模态窗圆角
- `--modal-shadow`: 模态窗阴影
- `--modal-padding`: 模态窗内边距

### 头部
- `--modal-header-padding`: 头部内边距
- `--modal-header-border-bottom`: 头部底部边框
- `--modal-header-bg-color`: 头部背景色
- `--modal-title-font-size`: 标题字号
- `--modal-title-font-weight`: 标题字重
- `--modal-title-color`: 标题颜色

### 内容区
- `--modal-content-padding`: 内容区内边距
- `--modal-content-bg-color`: 内容区背景色
- `--modal-content-color`: 内容区文字颜色

### 底部
- `--modal-footer-padding`: 底部内边距
- `--modal-footer-border-top`: 底部顶部边框
- `--modal-footer-bg-color`: 底部背景色

### 按钮样式

模态窗底部的按钮使用全局按钮主题变量：

**主要按钮（确认按钮）**:
- `--btn-primary-height`: 按钮高度
- `--btn-primary-padding-x`: 水平内边距
- `--btn-primary-padding-y`: 垂直内边距
- `--btn-primary-radius`: 圆角
- `--btn-primary-border-width`: 边框宽度
- `--btn-primary-border-color`: 边框颜色
- `--btn-primary-bg-color`: 背景色
- `--btn-primary-text-color`: 文字颜色
- `--btn-primary-hover-bg-color`: 悬停背景色
- `--btn-primary-hover-text-color`: 悬停文字颜色
- `--btn-primary-hover-border-color`: 悬停边框颜色
- `--btn-primary-disabled-bg-color`: 禁用背景色
- `--btn-primary-disabled-text-color`: 禁用文字颜色
- `--btn-primary-disabled-border-color`: 禁用边框颜色

**次要按钮（取消按钮）**:
- `--btn-outline-height`: 按钮高度
- `--btn-outline-padding-x`: 水平内边距
- `--btn-outline-padding-y`: 垂直内边距
- `--btn-outline-radius`: 圆角
- `--btn-outline-border-width`: 边框宽度
- `--btn-outline-border-color`: 边框颜色
- `--btn-outline-bg-color`: 背景色
- `--btn-outline-text-color`: 文字颜色
- `--btn-outline-hover-bg-color`: 悬停背景色
- `--btn-outline-hover-text-color`: 悬停文字颜色
- `--btn-outline-hover-border-color`: 悬停边框颜色
- `--btn-outline-disabled-bg-color`: 禁用背景色
- `--btn-outline-disabled-text-color`: 禁用文字颜色
- `--btn-outline-disabled-border-color`: 禁用边框颜色

## 高级用法

### 自定义头部

```vue
<Modal v-model="showModal">
  <template #header>
    <div class="custom-header">
      <span class="i-carbon-warning"></span>
      <h3>警告</h3>
    </div>
  </template>
  <p>这是一个警告信息</p>
</Modal>
```

### 自定义底部

```vue
<Modal v-model="showModal" title="自定义底部">
  <template #footer>
    <button @click="handleAction1">操作1</button>
    <button @click="handleAction2">操作2</button>
    <button @click="handleAction3">操作3</button>
  </template>
  <p>内容</p>
</Modal>
```

### 不显示底部

```vue
<Modal v-model="showModal" title="无底部" :show-footer="false">
  <p>这个模态窗没有底部按钮</p>
</Modal>
```

### 禁止点击遮罩关闭

```vue
<Modal
  v-model="showModal"
  title="强制操作"
  :close-on-click-outside="false"
>
  <p>必须点击按钮才能关闭</p>
</Modal>
```

### 加载状态

```vue
<script setup lang="ts">
import { ref } from 'vue'
import Modal from '@/components/Modal.vue'

const showModal = ref(false)
const loading = ref(false)

const handleConfirm = async () => {
  loading.value = true
  try {
    await someAsyncOperation()
    showModal.value = false
  } finally {
    loading.value = false
  }
}
</script>

<template>
  <Modal
    v-model="showModal"
    title="异步操作"
    :confirm-loading="loading"
    @confirm="handleConfirm"
  >
    <p>点击确认后将执行异步操作</p>
  </Modal>
</template>
```

## 实际应用示例

### 用户创建表单

```vue
<script setup lang="ts">
import { ref } from 'vue'
import Modal from '@/components/Modal.vue'
import { createUser } from '@/api/user'

const showCreateModal = ref(false)
const creating = ref(false)
const form = ref({
  name: '',
  email: '',
  role: 'student'
})

const handleCreate = async () => {
  creating.value = true
  try {
    await createUser(form.value)
    alert('创建成功')
    showCreateModal.value = false
  } catch (error) {
    alert('创建失败')
  } finally {
    creating.value = false
  }
}
</script>

<template>
  <button @click="showCreateModal = true">新增用户</button>
  
  <Modal
    v-model="showCreateModal"
    title="新增用户"
    size="medium"
    confirm-text="确认创建"
    :confirm-loading="creating"
    @confirm="handleCreate"
  >
    <div class="form-field">
      <label>姓名</label>
      <input v-model="form.name" type="text" />
    </div>
    <div class="form-field">
      <label>邮箱</label>
      <input v-model="form.email" type="email" />
    </div>
    <div class="form-field">
      <label>角色</label>
      <select v-model="form.role">
        <option value="student">学生</option>
        <option value="teacher">教师</option>
      </select>
    </div>
  </Modal>
</template>
```

### 确认对话框

```vue
<script setup lang="ts">
import { ref } from 'vue'
import Modal from '@/components/Modal.vue'

const showConfirm = ref(false)

const handleDelete = () => {
  showConfirm.value = true
}

const confirmDelete = async () => {
  // 执行删除操作
  await deleteItem()
  showConfirm.value = false
}
</script>

<template>
  <button @click="handleDelete">删除</button>
  
  <Modal
    v-model="showConfirm"
    title="确认删除"
    size="small"
    confirm-text="确认删除"
    cancel-text="取消"
    @confirm="confirmDelete"
  >
    <p>确定要删除这条记录吗？此操作不可撤销。</p>
  </Modal>
</template>
```

## 注意事项

1. **防止 body 滚动**：模态窗打开时会自动阻止 body 滚动，关闭时恢复。

2. **Teleport 到 body**：模态窗使用 `<Teleport to="body">` 渲染到 body 根节点，避免 z-index 和定位问题。

3. **动画效果**：内置淡入淡出和滑动动画，无需额外配置。

4. **响应式设计**：模态窗在移动设备上会自动适配，保持 1rem 的外边距。

5. **键盘交互**：未来版本将支持 ESC 键关闭模态窗。

## 与组件画廊的集成

`Modal` 组件**完全绑定到组件画廊的模态窗设置**，在"开发管理 > 组件画廊 > 模态窗"中调整的所有设置会**实时同步**到所有使用 `Modal` 组件的地方。

### 可配置项

1. **尺寸与形状**
   - 默认尺寸（小/标准/大/超大）
   - 圆角大小
   - 内边距

2. **遮罩层**
   - 背景颜色
   - 透明度（滑竿调节）
   - 模糊度

3. **容器样式**
   - 背景色
   - 阴影效果

4. **头部样式**
   - 背景色
   - 边框样式
   - 内边距
   - 标题颜色、字号、字重

5. **内容区样式**
   - 背景色
   - 文字颜色
   - 内边距

6. **底部样式**
   - 背景色
   - 边框样式
   - 内边距

7. **按钮样式**
   - 按钮样式继承自"组件画廊 > 基础控件 > 按钮"的设置
   - 主要按钮（确认）使用主要按钮样式
   - 次要按钮（取消）使用次要按钮样式

### 实时预览

在组件画廊中调整任何设置后，点击"打开预览"按钮可以立即看到效果。所有修改会自动应用到系统中的所有模态窗，包括：

- 用户管理的新增/编辑用户模态窗
- 确认删除对话框
- 其他所有使用 `Modal` 组件的地方

### 样式一致性

由于 `Modal` 组件完全使用主题变量，因此：

✅ **全局一致性**: 所有模态窗的外观完全一致  
✅ **主题适配**: 切换全局主题色时，模态窗会自动适配  
✅ **零硬编码**: 没有任何硬编码的颜色或尺寸值  
✅ **实时更新**: 在组件画廊中的修改会立即生效

## 更新日志

### v1.0.0 (2025-11-24)
- ✨ 初始版本发布
- ✨ 支持四种尺寸
- ✨ 完整的插槽系统
- ✨ 主题变量绑定
- ✨ 加载状态支持
- ✨ 动画效果

