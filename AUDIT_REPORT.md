# DongUI v1.0 å…¨é¢ä»£ç å®¡è®¡æŠ¥å‘Š

**å®¡è®¡æ—¥æœŸ**: 2024-11-24  
**é¡¹ç›®ç‰ˆæœ¬**: v1.0  
**å®¡è®¡èŒƒå›´**: å…¨æ ˆç³»ç»Ÿï¼ˆå‰ç«¯ + åç«¯ + æ•°æ®åº“ï¼‰

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### æ€»ä½“è¯„ä¼°

DongUI v1.0 æ˜¯ä¸€ä¸ªè®¾è®¡ç²¾è‰¯çš„å…¨æ ˆè„šæ‰‹æ¶é¡¹ç›®ï¼Œå…·æœ‰åˆ›æ–°çš„åŠ¨æ€ä¸»é¢˜ç³»ç»Ÿå’Œå®Œå–„çš„ç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚é¡¹ç›®æ¶æ„æ¸…æ™°ï¼Œä»£ç è´¨é‡è¾ƒé«˜ï¼Œä½†åœ¨å®‰å…¨æ€§ã€æ€§èƒ½ä¼˜åŒ–å’ŒåŠŸèƒ½å®Œæ•´æ€§æ–¹é¢ä»æœ‰è¾ƒå¤§çš„æ”¹è¿›ç©ºé—´ã€‚

### è¯„åˆ†æ¦‚è§ˆ

| ç»´åº¦ | è¯„åˆ† | ç­‰çº§ |
|------|------|------|
| **æ¶æ„è®¾è®¡** | 85/100 | ğŸŸ¢ ä¼˜ç§€ |
| **ä»£ç è´¨é‡** | 80/100 | ğŸŸ¢ è‰¯å¥½ |
| **å®‰å…¨æ€§** | 45/100 | ğŸ”´ éœ€æ”¹è¿› |
| **æ€§èƒ½** | 65/100 | ğŸŸ¡ ä¸€èˆ¬ |
| **åŠŸèƒ½å®Œæ•´æ€§** | 60/100 | ğŸŸ¡ ä¸€èˆ¬ |
| **æ–‡æ¡£è´¨é‡** | 90/100 | ğŸŸ¢ ä¼˜ç§€ |
| **ç»¼åˆè¯„åˆ†** | **71/100** | ğŸŸ¡ **è‰¯å¥½** |

### å…³é”®å‘ç°

#### âœ… ä¼˜åŠ¿
1. **åˆ›æ–°çš„ä¸»é¢˜ç³»ç»Ÿ**: åŠ¨æ€åŒ–UIå…¨å±€æ§åˆ¶å®ç°ä¼˜ç§€ï¼Œç»„ä»¶ç”»å»ŠåŠŸèƒ½å¼ºå¤§
2. **å®Œå–„çš„æ–‡æ¡£**: é¡¹ç›®æ–‡æ¡£ç»“æ„æ¸…æ™°ï¼Œå†…å®¹è¯¦å®
3. **è‰¯å¥½çš„ä»£ç ç»„ç»‡**: Monorepoç»“æ„ï¼Œæ¨¡å—åŒ–è®¾è®¡
4. **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: Vue 3 + NestJS + Prismaï¼ŒæŠ€æœ¯é€‰å‹åˆç†

#### âš ï¸ å…³é”®é—®é¢˜
1. **ç¼ºå°‘è®¤è¯æˆæƒ**: æ— ç™»å½•ã€æ³¨å†Œã€JWTè®¤è¯æœºåˆ¶
2. **å®‰å…¨æ¼æ´**: CORSå…¨å¼€æ”¾ï¼Œå¯†ç æœªåŠ ç›ï¼Œæ— è¾“å…¥éªŒè¯
3. **æ€§èƒ½æœªä¼˜åŒ–**: ç¼ºå°‘ç¼“å­˜ã€æ•°æ®åº“ç´¢å¼•ä¸è¶³ã€å‰ç«¯æœªåˆ†å—
4. **åŠŸèƒ½ä¸å®Œæ•´**: æƒé™ç®¡ç†ã€æ–‡ä»¶ä¸Šä¼ ã€æ—¥å¿—ç³»ç»Ÿå‡ç¼ºå¤±

---

## ğŸ—ï¸ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¶æ„åˆ†æ

### 1.1 æ•´ä½“æ¶æ„è®¾è®¡ (è¯„åˆ†: 85/100)

#### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯åº”ç”¨å±‚                      â”‚
â”‚   Vue 3 + TypeScript + UnoCSS           â”‚
â”‚   â€¢ åŠ¨æ€ä¸»é¢˜ç³»ç»Ÿ                          â”‚
â”‚   â€¢ ç»„ä»¶ç”»å»Š                              â”‚
â”‚   â€¢ ç”¨æˆ·ç®¡ç†ç•Œé¢                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ RESTful API
                  â”‚ Axios/Fetch
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åç«¯æœåŠ¡å±‚                      â”‚
â”‚   NestJS + TypeScript                   â”‚
â”‚   â€¢ ç”¨æˆ·æ¨¡å—                              â”‚
â”‚   â€¢ è§’è‰²æ¨¡å—                              â”‚
â”‚   â€¢ é…ç½®æ¨¡å—                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Prisma ORM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®å­˜å‚¨å±‚                      â”‚
â”‚   PostgreSQL 16 + pgvector              â”‚
â”‚   Redis (æœªä½¿ç”¨)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¼˜ç‚¹

âœ… **Monorepo æ¶æ„**: ä½¿ç”¨ pnpm workspace ç®¡ç†å¤šåŒ…ï¼Œç»“æ„æ¸…æ™°
```yaml
# pnpm-workspace.yaml
packages:
  - 'apps/*'
  - 'packages/*'
```

âœ… **æ¨¡å—åŒ–è®¾è®¡**: å‰åç«¯éƒ½é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼ŒèŒè´£åˆ†ç¦»æ˜ç¡®
- å‰ç«¯: `/views` (é¡µé¢) + `/components` (ç»„ä»¶) + `/api` (æ¥å£)
- åç«¯: æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ (User/Role/Config)

âœ… **é…ç½®é›†ä¸­åŒ–**: ä¸»é¢˜é…ç½®ç»Ÿä¸€ç®¡ç†ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½å’ŒæŒä¹…åŒ–

#### é—®é¢˜

âš ï¸ **ç¼ºå°‘ä¸­é—´å±‚**: å‰ç«¯ç›´æ¥è°ƒç”¨åç«¯APIï¼Œæ— APIç½‘å…³æˆ–BFFå±‚  
âš ï¸ **Redisæœªä½¿ç”¨**: Docker composeä¸­é…ç½®äº†Redisä½†æœªé›†æˆ  
âš ï¸ **ç¼ºå°‘æœåŠ¡å‘ç°**: ç¡¬ç¼–ç ç«¯å£å’Œåœ°å€ï¼Œä¸åˆ©äºæ‰©å±•

#### å»ºè®®

1. **å¼•å…¥APIç½‘å…³**: ç»Ÿä¸€ç®¡ç†è·¯ç”±ã€è®¤è¯ã€é™æµ
2. **å®ç°Redisç¼“å­˜**: ç”¨äºä¼šè¯ç®¡ç†ã€é…ç½®ç¼“å­˜
3. **ä½¿ç”¨ç¯å¢ƒå˜é‡**: ç®¡ç†ä¸åŒç¯å¢ƒçš„é…ç½®

### 1.2 æŠ€æœ¯æ ˆé€‰å‹ (è¯„åˆ†: 90/100)

#### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯„ä»· |
|------|------|------|
| Vue | 3.3.4 | âœ… ä½¿ç”¨æœ€æ–°çš„Composition API |
| TypeScript | 5.0.2 | âœ… ç±»å‹å®šä¹‰å®Œå–„ |
| Vite | 4.4.5 | âœ… å¿«é€Ÿçš„æ„å»ºå·¥å…· |
| UnoCSS | 0.55.3 | âœ… åŸå­åŒ–CSSå¼•æ“ |
| Vue Router | 4.2.4 | âœ… å®˜æ–¹è·¯ç”± |

**ä¼˜ç‚¹**: 
- æŠ€æœ¯é€‰å‹ç°ä»£åŒ–ï¼Œæ€§èƒ½ä¼˜ç§€
- æ— é‡é‡çº§UIæ¡†æ¶ä¾èµ–ï¼Œè‡ªå®šä¹‰çµæ´»

**é—®é¢˜**:
- ç¼ºå°‘çŠ¶æ€ç®¡ç† (Piniaè™½ç„¶å®‰è£…ä½†æœªä½¿ç”¨)
- ç¼ºå°‘è¯·æ±‚æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†

#### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯„ä»· |
|------|------|------|
| NestJS | 10.0.0 | âœ… ä¼ä¸šçº§Node.jsæ¡†æ¶ |
| Prisma | 5.5.2 | âœ… ç°ä»£åŒ–ORM |
| PostgreSQL | 16 | âœ… å¼ºå¤§çš„å…³ç³»å‹æ•°æ®åº“ |
| bcrypt | 6.0.0 | âœ… å¯†ç åŠ å¯† |

**ä¼˜ç‚¹**:
- NestJSæä¾›äº†å®Œæ•´çš„ä¾èµ–æ³¨å…¥å’Œæ¨¡å—åŒ–ç³»ç»Ÿ
- Prismaæä¾›äº†ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®

**é—®é¢˜**:
- ç¼ºå°‘JWTè®¤è¯åº“
- ç¼ºå°‘æ•°æ®éªŒè¯åº“ (class-validator)
- ç¼ºå°‘æ—¥å¿—åº“ (winston/pino)

### 1.3 æ•°æ®åº“è®¾è®¡ (è¯„åˆ†: 75/100)

#### Schema åˆ†æ

```prisma
// å½“å‰Schema
model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String
  password  String   // âŒ æœªåŠ ç›
  roleId    String
  role      Role     @relation(...)
  status    Boolean  @default(true)
  // ... å…¶ä»–å­—æ®µ
}

model Role {
  id          String   @id @default(uuid())
  name        String
  key         String   @unique
  isSystem    Boolean  @default(false)
  // âŒ ç¼ºå°‘æƒé™å…³è”
}

model SystemConfig {
  id    String @id @default(uuid())
  key   String @unique
  value Json   // âœ… ä½¿ç”¨JSONBå­˜å‚¨é…ç½®
}
```

#### ä¼˜ç‚¹

âœ… **UUIDä½œä¸ºä¸»é”®**: é¿å…IDæ³„éœ²å’ŒçŒœæµ‹  
âœ… **JSONBå­—æ®µ**: çµæ´»å­˜å‚¨å¤æ‚é…ç½®  
âœ… **pgvectoræ”¯æŒ**: ä¸ºAIå‘é‡æœç´¢é¢„ç•™æ‰©å±•

#### é—®é¢˜

âš ï¸ **ç¼ºå°‘ç´¢å¼•**: é™¤uniqueå¤–ï¼Œæ— å…¶ä»–ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢  
âš ï¸ **ç¼ºå°‘æ—¶é—´æˆ³ç´¢å¼•**: `createdAt`/`updatedAt`æœªå»ºç´¢å¼•  
âš ï¸ **ç¼ºå°‘è½¯åˆ é™¤**: ç”¨æˆ·åˆ é™¤æ˜¯ç¡¬åˆ é™¤ï¼Œæ— æ³•æ¢å¤  
âš ï¸ **ç¼ºå°‘æƒé™è¡¨**: RBACä¸å®Œæ•´ï¼Œæ— Permissionè¡¨

#### å»ºè®®

```prisma
model User {
  id        String    @id @default(uuid())
  email     String    @unique
  password  String
  roleId    String
  role      Role      @relation(...)
  deletedAt DateTime? // è½¯åˆ é™¤
  
  @@index([email]) // é‚®ç®±æŸ¥è¯¢ç´¢å¼•
  @@index([roleId]) // è§’è‰²æŸ¥è¯¢ç´¢å¼•
  @@index([createdAt]) // æ—¶é—´æ’åºç´¢å¼•
}

model Permission {
  id          String @id @default(uuid())
  name        String
  key         String @unique
  resource    String // èµ„æº
  action      String // æ“ä½œ (create/read/update/delete)
  roles       RolePermission[]
}

model RolePermission {
  roleId       String
  permissionId String
  role         Role       @relation(...)
  permission   Permission @relation(...)
  
  @@id([roleId, permissionId])
}
```

---

## ğŸ’» ç¬¬äºŒéƒ¨åˆ†ï¼šä»£ç è´¨é‡è¯„ä¼°

### 2.1 å‰ç«¯ä»£ç è´¨é‡ (è¯„åˆ†: 80/100)

#### Vueç»„ä»¶è®¾è®¡

**ä¼˜ç‚¹**:
- âœ… ä½¿ç”¨ Composition APIï¼Œä»£ç ç»„ç»‡æ¸…æ™°
- âœ… TypeScriptç±»å‹å®šä¹‰å®Œå–„
- âœ… Propså’ŒEmitså®šä¹‰è§„èŒƒ

**ç¤ºä¾‹ - Modalç»„ä»¶** (é«˜è´¨é‡):
```vue
<script setup lang="ts">
const props = withDefaults(defineProps<{
  modelValue: boolean
  title?: string
  size?: 'small' | 'medium' | 'large' | 'xlarge'
}>(), {
  size: 'medium',
})

const emit = defineEmits<{
  (e: 'update:modelValue', value: boolean): void
  (e: 'confirm'): void
}>()
</script>
```

**é—®é¢˜**:

âŒ **ç»„ä»¶æœªå¤ç”¨**: `ActionMenu`, `Modal` ç­‰ä¼˜ç§€ç»„ä»¶æœªåœ¨`index.ts`å¯¼å‡º
```typescript
// apps/web/src/components/index.ts
// âŒ å½“å‰æ˜¯ç©ºçš„ï¼Œåº”è¯¥å¯¼å‡ºæ‰€æœ‰ç»„ä»¶
export { default as Modal } from './Modal.vue'
export { default as ActionMenu } from './ActionMenu.vue'
export { default as RichTextEditor } from './RichTextEditor.vue'
```

âŒ **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨è¿‡é•¿**: `RichTextEditor.vue` è¶…è¿‡900è¡Œï¼Œåº”æ‹†åˆ†

```vue
<!-- å»ºè®®æ‹†åˆ†ä¸º -->
<!-- RichTextEditor.vue (ä¸»æ–‡ä»¶) -->
<!-- Toolbar.vue (å·¥å…·æ ) -->
<!-- Editor.vue (ç¼–è¾‘åŒºåŸŸ) -->
<!-- ImageUploader.vue (å›¾ç‰‡ä¸Šä¼ ) -->
```

âŒ **ç¼ºå°‘é”™è¯¯è¾¹ç•Œ**: ç»„ä»¶é”™è¯¯ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒ

#### çŠ¶æ€ç®¡ç†

**é—®é¢˜**:
- âŒ **æœªä½¿ç”¨Pinia**: è™½ç„¶å®‰è£…ä½†æœªä½¿ç”¨ï¼Œå…¨å±€çŠ¶æ€æ•£è½å„å¤„
- âŒ **themeConfigç›´æ¥æš´éœ²**: ä½¿ç”¨reactiveå¯¼å‡ºï¼Œæ— å°è£…

**å»ºè®®**:
```typescript
// stores/theme.ts
import { defineStore } from 'pinia'

export const useThemeStore = defineStore('theme', () => {
  const config = ref(defaultThemeConfig)
  
  const updateTheme = async (newConfig) => {
    config.value = newConfig
    applyTheme(newConfig)
    await saveRemoteThemeConfig(newConfig)
  }
  
  return { config, updateTheme }
})
```

#### APIå±‚è®¾è®¡

**ä¼˜ç‚¹**:
- âœ… APIæŒ‰æ¨¡å—åˆ†ç¦» (`user.ts`, `role.ts`, `config.ts`)
- âœ… ä½¿ç”¨TypeScriptæ¥å£å®šä¹‰è¿”å›ç±»å‹

**é—®é¢˜**:
- âŒ **æ··ç”¨axioså’Œfetch**: `role.ts`ç”¨axiosï¼Œ`user.ts`ç”¨fetch
- âŒ **æ— ç»Ÿä¸€é”™è¯¯å¤„ç†**: æ¯ä¸ªAPIéƒ½éœ€å•ç‹¬try-catch
- âŒ **æ— è¯·æ±‚æ‹¦æˆªå™¨**: æœªæ¥æ·»åŠ tokenæ—¶éœ€æ”¹æ‰€æœ‰API

**å»ºè®®**:
```typescript
// api/client.ts
import axios from 'axios'

const apiClient = axios.create({
  baseURL: '/api',
  timeout: 10000,
})

// è¯·æ±‚æ‹¦æˆªå™¨
apiClient.interceptors.request.use((config) => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// å“åº”æ‹¦æˆªå™¨
apiClient.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // è·³è½¬ç™»å½•
    }
    return Promise.reject(error)
  }
)

export default apiClient
```

### 2.2 åç«¯ä»£ç è´¨é‡ (è¯„åˆ†: 75/100)

#### NestJSæ¨¡å—è®¾è®¡

**ä¼˜ç‚¹**:
- âœ… æ¨¡å—åŒ–è®¾è®¡æ¸…æ™° (User/Role/Configå„è‡ªç‹¬ç«‹)
- âœ… ä¾èµ–æ³¨å…¥ä½¿ç”¨å¾—å½“
- âœ… Serviceå±‚ä¸šåŠ¡é€»è¾‘å°è£…è‰¯å¥½

**é—®é¢˜**:
- âŒ **ç¼ºå°‘DTOéªŒè¯**: æ¥å£å‚æ•°æœªéªŒè¯

```typescript
// âŒ å½“å‰ä»£ç  - æ— éªŒè¯
@Post()
async create(@Body() createUserDto: CreateUserDto) {
  return this.userService.create(createUserDto);
}

// âœ… åº”è¯¥ä½¿ç”¨ class-validator
import { IsEmail, IsString, MinLength } from 'class-validator';

export class CreateUserDto {
  @IsEmail()
  email: string;

  @IsString()
  @MinLength(2)
  name: string;

  @IsString()
  @MinLength(8)
  password: string;
}
```

âŒ **ç¼ºå°‘å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨**: é”™è¯¯ä¿¡æ¯ç›´æ¥æš´éœ²

```typescript
// âŒ å½“å‰: é”™è¯¯ç›´æ¥è¿”å›ç»™å‰ç«¯
if (!user) {
  throw new NotFoundException(`User with ID ${id} not found`);
}

// âœ… åº”è¯¥ç»Ÿä¸€å¤„ç†
@Catch()
export class HttpExceptionFilter implements ExceptionFilter {
  catch(exception: HttpException, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse();
    const status = exception.getStatus();
    
    response.status(status).json({
      statusCode: status,
      message: exception.message,
      timestamp: new Date().toISOString(),
    });
  }
}
```

âŒ **å¯†ç å¤„ç†ä¸å®‰å…¨**: bcryptæœªåŠ ç›è½®æ•°

```typescript
// âŒ å½“å‰
const hashedPassword = await bcrypt.hash(data.password, 10);

// âœ… åº”è¯¥
const saltRounds = 12; // æé«˜å®‰å…¨æ€§
const hashedPassword = await bcrypt.hash(data.password, saltRounds);
```

#### APIè®¾è®¡

**ä¼˜ç‚¹**:
- âœ… RESTfulè§„èŒƒ: ä½¿ç”¨æ ‡å‡†HTTPæ–¹æ³•
- âœ… è·¯å¾„è®¾è®¡åˆç†: `/users`, `/roles`, `/config`

**é—®é¢˜**:
- âŒ **æ— ç‰ˆæœ¬æ§åˆ¶**: APIè·¯å¾„åº”åŒ…å«ç‰ˆæœ¬å· `/api/v1/users`
- âŒ **æ— åˆ†é¡µ**: `findAll`æŸ¥è¯¢å…¨éƒ¨æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜
- âŒ **æ— æ’åº/è¿‡æ»¤**: æŸ¥è¯¢åŠŸèƒ½è¿‡äºç®€å•

**å»ºè®®**:
```typescript
// å¸¦åˆ†é¡µçš„æŸ¥è¯¢
@Get()
async findAll(
  @Query('page') page: number = 1,
  @Query('limit') limit: number = 10,
  @Query('search') search?: string,
  @Query('roleKey') roleKey?: string,
  @Query('sortBy') sortBy: string = 'createdAt',
  @Query('sortOrder') sortOrder: 'asc' | 'desc' = 'desc',
) {
  const skip = (page - 1) * limit;
  
  return this.userService.findAll({
    skip,
    take: limit,
    search,
    roleKey,
    orderBy: { [sortBy]: sortOrder },
  });
}
```

---

## ğŸ”’ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®‰å…¨æ€§è¯„ä¼°

### 3.1 è®¤è¯æˆæƒ (è¯„åˆ†: 0/100)

#### ä¸¥é‡é—®é¢˜

ğŸ”´ **å®Œå…¨ç¼ºå¤±è®¤è¯ç³»ç»Ÿ**
- æ— ç™»å½•/æ³¨å†ŒåŠŸèƒ½
- æ— JWT/Sessionç®¡ç†
- æ‰€æœ‰APIéƒ½æ˜¯å…¬å¼€çš„

ğŸ”´ **æ— æƒé™æ§åˆ¶**
- è™½æœ‰Roleè¡¨ï¼Œä½†æœªå®ç°æƒé™æ£€æŸ¥
- ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®æ‰€æœ‰æ¥å£

#### å¿…é¡»å®ç°

```typescript
// 1. JWTè®¤è¯å®ˆå«
@Injectable()
export class JwtAuthGuard extends AuthGuard('jwt') {
  canActivate(context: ExecutionContext) {
    return super.canActivate(context);
  }
}

// 2. è§’è‰²å®ˆå«
@Injectable()
export class RolesGuard implements CanActivate {
  canActivate(context: ExecutionContext): boolean {
    const requiredRoles = this.reflector.get<string[]>('roles', context.getHandler());
    const request = context.switchToHttp().getRequest();
    const user = request.user;
    
    return requiredRoles.some((role) => user.role === role);
  }
}

// 3. ä½¿ç”¨å®ˆå«
@Controller('users')
@UseGuards(JwtAuthGuard, RolesGuard)
export class UserController {
  @Get()
  @Roles('ADMIN', 'SUPER_ADMIN')
  findAll() {
    // åªæœ‰ç®¡ç†å‘˜å¯è®¿é—®
  }
}
```

### 3.2 æ•°æ®å®‰å…¨ (è¯„åˆ†: 50/100)

#### å¯†ç å®‰å…¨

âš ï¸ **bcrypté…ç½®ä¸ä½³**
```typescript
// âŒ å½“å‰: ç›è½®æ•°å¤ªä½
await bcrypt.hash(password, 10);

// âœ… æ¨è: è‡³å°‘12è½®
await bcrypt.hash(password, 12);
```

âš ï¸ **å¯†ç è¿”å›ç»™å‰ç«¯**
```typescript
// âŒ å½“å‰: selectä¸­æœªæ’é™¤password
const user = await this.prisma.user.findUnique({
  where: { id },
  select: {
    id: true,
    email: true,
    name: true,
    // ... passwordæœªæ’é™¤
  },
});

// âœ… åº”è¯¥æ˜ç¡®æ’é™¤
select: {
  id: true,
  email: true,
  name: true,
  password: false, // æ˜ç¡®æ’é™¤
}
```

#### è¾“å…¥éªŒè¯

ğŸ”´ **å®Œå…¨ç¼ºå¤±è¾“å…¥éªŒè¯**
- åç«¯æ— DTOéªŒè¯
- å‰ç«¯è¡¨å•æ— æ ¡éªŒé€»è¾‘
- å¯èƒ½å¯¼è‡´SQLæ³¨å…¥ã€XSSæ”»å‡»

**å¿…é¡»æ·»åŠ **:
```bash
# å®‰è£…ä¾èµ–
pnpm add class-validator class-transformer

# å¯ç”¨å…¨å±€éªŒè¯ç®¡é“
app.useGlobalPipes(new ValidationPipe({
  whitelist: true,  // å»é™¤æœªå®šä¹‰å­—æ®µ
  forbidNonWhitelisted: true, // æŠ›å‡ºé”™è¯¯
  transform: true, // è‡ªåŠ¨è½¬æ¢ç±»å‹
}));
```

### 3.3 ç½‘ç»œå®‰å…¨ (è¯„åˆ†: 40/100)

#### CORSé…ç½®

âš ï¸ **CORSå…¨å¼€æ”¾**
```typescript
// âŒ å½“å‰: å…è®¸æ‰€æœ‰æ¥æº
app.enableCors();

// âœ… åº”è¯¥é™åˆ¶æ¥æº
app.enableCors({
  origin: process.env.FRONTEND_URL || 'http://localhost:51730',
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
});
```

#### ç¼ºå°‘å®‰å…¨å¤´

```typescript
// å®‰è£… helmet
pnpm add helmet

// ä½¿ç”¨helmetè®¾ç½®å®‰å…¨å¤´
import helmet from 'helmet';
app.use(helmet());
```

#### ç¼ºå°‘é€Ÿç‡é™åˆ¶

```typescript
// å®‰è£…throttler
pnpm add @nestjs/throttler

// å…¨å±€é€Ÿç‡é™åˆ¶
@Module({
  imports: [
    ThrottlerModule.forRoot({
      ttl: 60,
      limit: 10,
    }),
  ],
})
```

### 3.4 æ•æ„Ÿæ•°æ®ä¿æŠ¤ (è¯„åˆ†: 50/100)

âš ï¸ **ç¯å¢ƒå˜é‡æœªä½¿ç”¨**
- æ•°æ®åº“å¯†ç ã€ç«¯å£ç­‰ç¡¬ç¼–ç åœ¨`docker-compose.yml`
- æ— `.env`æ–‡ä»¶ç®¡ç†æ•æ„Ÿé…ç½®

**å»ºè®®**:
```bash
# .env
DATABASE_URL="postgresql://admin:secure_password@localhost:54320/dong_db"
JWT_SECRET="your-secret-key-here"
PORT=50000
```

âš ï¸ **æ—¥å¿—å¯èƒ½æ³„éœ²ä¿¡æ¯**
- é”™è¯¯ä¿¡æ¯ç›´æ¥è¿”å›ç»™å‰ç«¯
- å¯èƒ½åŒ…å«æ•°æ®åº“ç»“æ„ã€è·¯å¾„ç­‰æ•æ„Ÿä¿¡æ¯

---

## âš¡ ç¬¬å››éƒ¨åˆ†ï¼šæ€§èƒ½è¯„ä¼°

### 4.1 å‰ç«¯æ€§èƒ½ (è¯„åˆ†: 60/100)

#### æ„å»ºä¼˜åŒ–

âš ï¸ **æœªé…ç½®ä»£ç åˆ†å‰²**
```typescript
// vite.config.ts åº”æ·»åŠ 
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'vue-vendor': ['vue', 'vue-router'],
          'ui-components': [
            './src/components/Modal.vue',
            './src/components/ActionMenu.vue',
          ],
        },
      },
    },
  },
})
```

âš ï¸ **è·¯ç”±æ‡’åŠ è½½ä¸ä¸€è‡´**
```typescript
// âŒ æ··ç”¨é™æ€å¯¼å…¥å’ŒåŠ¨æ€å¯¼å…¥
import Dashboard from '../views/admin/Dashboard.vue' // é™æ€
{ path: 'gallery', component: () => import('...') } // åŠ¨æ€

// âœ… åº”ç»Ÿä¸€ä½¿ç”¨æ‡’åŠ è½½
{ path: '', component: () => import('../views/admin/Dashboard.vue') }
```

#### è¿è¡Œæ—¶æ€§èƒ½

âš ï¸ **ä¸»é¢˜ç³»ç»Ÿæ€§èƒ½é—®é¢˜**
```typescript
// applyThemeå‡½æ•°æ¯æ¬¡éƒ½éå†æ•´ä¸ªé…ç½®å¯¹è±¡
// å½“é…ç½®é¡¹è¶…è¿‡100ä¸ªæ—¶ï¼Œå¯èƒ½å¡é¡¿

// âœ… å»ºè®®ä¼˜åŒ–
const themeCache = new Map();
function applyTheme(theme) {
  const cacheKey = JSON.stringify(theme);
  if (themeCache.has(cacheKey)) {
    return;
  }
  // ... åº”ç”¨ä¸»é¢˜
  themeCache.set(cacheKey, true);
}
```

âš ï¸ **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æœªé˜²æŠ–**
```typescript
// RichTextEditor.vue
// âŒ æ¯æ¬¡è¾“å…¥éƒ½è§¦å‘update
const handleInput = () => {
  emit('update:modelValue', editorRef.value?.innerHTML || '')
}

// âœ… åº”è¯¥ä½¿ç”¨é˜²æŠ–
import { useDebounceFn } from '@vueuse/core'
const handleInput = useDebounceFn(() => {
  emit('update:modelValue', editorRef.value?.innerHTML || '')
}, 300)
```

### 4.2 åç«¯æ€§èƒ½ (è¯„åˆ†: 65/100)

#### æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

âš ï¸ **N+1æŸ¥è¯¢é—®é¢˜**
```typescript
// âŒ UserService.findAll()
// æŸ¥è¯¢ç”¨æˆ·æ—¶ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šå•ç‹¬æŸ¥è¯¢role
const users = await this.prisma.user.findMany({
  include: { role: true } // ä¼šäº§ç”ŸN+1æŸ¥è¯¢
});

// âœ… ä½¿ç”¨selectä¼˜åŒ–
const users = await this.prisma.user.findMany({
  select: {
    id: true,
    name: true,
    role: {
      select: { id: true, name: true, key: true }
    }
  }
});
```

âš ï¸ **ç¼ºå°‘åˆ†é¡µ**: æ‰€æœ‰æŸ¥è¯¢éƒ½è¿”å›å…¨éƒ¨æ•°æ®

âš ï¸ **ç¼ºå°‘ç´¢å¼•**: æ•°æ®åº“è¡¨é™¤uniqueå¤–æ— å…¶ä»–ç´¢å¼•

```prisma
// å»ºè®®æ·»åŠ ç´¢å¼•
model User {
  // ...
  @@index([email])
  @@index([roleId])
  @@index([createdAt])
  @@index([status])
}
```

#### ç¼“å­˜ç­–ç•¥

ğŸ”´ **å®Œå…¨æ²¡æœ‰ç¼“å­˜**
- Rediså·²é…ç½®ä½†æœªä½¿ç”¨
- é…ç½®ã€è§’è‰²ç­‰é™æ€æ•°æ®åº”è¯¥ç¼“å­˜

**å»ºè®®å®ç°**:
```typescript
// å®‰è£…cache-manager
pnpm add cache-manager cache-manager-redis-store

// config.module.ts
@Module({
  imports: [
    CacheModule.register({
      store: redisStore,
      host: 'localhost',
      port: 56379,
      ttl: 3600,
    }),
  ],
})
export class ConfigModule {}

// config.service.ts
@Injectable()
export class ConfigService {
  constructor(
    private prisma: PrismaService,
    @Inject(CACHE_MANAGER) private cacheManager: Cache,
  ) {}
  
  async getConfig(key: string) {
    // å…ˆæŸ¥ç¼“å­˜
    const cached = await this.cacheManager.get(`config:${key}`);
    if (cached) return cached;
    
    // æŸ¥æ•°æ®åº“
    const config = await this.prisma.systemConfig.findUnique({ where: { key } });
    
    // å†™å…¥ç¼“å­˜
    await this.cacheManager.set(`config:${key}`, config, { ttl: 3600 });
    
    return config;
  }
}
```

### 4.3 ç½‘ç»œä¼˜åŒ– (è¯„åˆ†: 70/100)

âœ… **Viteä»£ç†é…ç½®**: å¼€å‘ç¯å¢ƒä»£ç†æ­£ç¡®é…ç½®

âš ï¸ **æœªå¯ç”¨å‹ç¼©**
```typescript
// main.ts åº”æ·»åŠ 
import compression from 'compression';
app.use(compression());
```

âš ï¸ **æœªè®¾ç½®é™æ€èµ„æºç¼“å­˜å¤´**

---

## ğŸ“¦ ç¬¬äº”éƒ¨åˆ†ï¼šåŠŸèƒ½å®Œæ•´æ€§è¯„ä¼°

### 5.1 å·²å®ç°åŠŸèƒ½ (è¯„åˆ†: 70/100)

#### âœ… æ ¸å¿ƒåŠŸèƒ½ - åŠ¨æ€ä¸»é¢˜ç³»ç»Ÿ (95åˆ†)

**ä¼˜ç§€å®ç°**:
1. **ç»„ä»¶ç”»å»Š**: å¯è§†åŒ–é…ç½®æ‰€æœ‰UIå…ƒç´ 
2. **å®æ—¶é¢„è§ˆ**: ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ
3. **é…ç½®æŒä¹…åŒ–**: ä¿å­˜åˆ°æ•°æ®åº“
4. **é…ç½®å¯¼å…¥å¯¼å‡º**: JSONæ ¼å¼

**äº®ç‚¹**:
```typescript
// æ™ºèƒ½é¢œè‰²å›é€€ç³»ç»Ÿ
const resolveColor = (color: string, fallbackVar: string) => {
  if (!color) return `var(${fallbackVar})`;
  if (color.startsWith('var')) return color;
  return color;
};

// æ·±åº¦åˆå¹¶é…ç½®
function deepMerge(target: any, source: any) {
  // ä¿ç•™æœ¬åœ°é»˜è®¤å€¼ï¼Œåªè¦†ç›–è¿œç¨‹é…ç½®çš„å­—æ®µ
}
```

**å¯æ”¹è¿›**:
- é…ç½®ç‰ˆæœ¬æ§åˆ¶
- ä¸»é¢˜é¢„è®¾æ¨¡æ¿
- é…ç½®å›æ»šåŠŸèƒ½

#### âœ… ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ (80åˆ†)

**å·²å®ç°**:
- ç”¨æˆ·CRUDæ“ä½œ
- è§’è‰²ç»‘å®š
- çŠ¶æ€å¯ç”¨/ç¦ç”¨
- æœç´¢å’Œè¿‡æ»¤
- è¯¦ç»†ä¿¡æ¯å±•ç¤º

**ä¼˜ç‚¹**:
- ä»£ç ç»“æ„æ¸…æ™°
- ç±»å‹å®šä¹‰å®Œå–„
- UIå‹å¥½

**é—®é¢˜**:
- æ— æ‰¹é‡æ“ä½œ
- æ— å¯¼å‡ºåŠŸèƒ½
- æ— æ“ä½œæ—¥å¿—

#### âœ… å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ (85åˆ†)

**åŠŸèƒ½å®Œæ•´**:
- æ–‡æœ¬æ ¼å¼åŒ–
- å›¾ç‰‡æ’å…¥å’Œè°ƒæ•´
- é¢œè‰²é€‰æ‹©å™¨
- æ’¤é”€/é‡åš
- è‡ªå®šä¹‰å·¥å…·æ 

**ä¼˜ç‚¹**:
- åŠŸèƒ½ä¸°å¯Œ
- UIç»Ÿä¸€
- å¯æ‰©å±•æ€§å¥½

**é—®é¢˜**:
- ä»£ç è¿‡é•¿ï¼ˆ900+è¡Œï¼‰
- å›¾ç‰‡ä¸Šä¼ æœªå®ç°
- æ— è¡¨æ ¼æ”¯æŒ

#### âœ… æ–‡æ¡£ç³»ç»Ÿ (90åˆ†)

**ä¼˜ç§€å®ç°**:
- Markdownæ¸²æŸ“
- ä»£ç é«˜äº®
- ç›®å½•å¯¼èˆª
- æ–‡æ¡£åˆ†ç±»æ¸…æ™°

**æ–‡æ¡£ç»“æ„**:
```
docs/
â”œâ”€â”€ 00_å¿«é€Ÿå¼€å§‹/
â”œâ”€â”€ 01_è§„èŒƒæŒ‡å—/
â”‚   â”œâ”€â”€ é¡¹ç›®ç»“æ„
â”‚   â”œâ”€â”€ Gitè§„èŒƒ
â”‚   â””â”€â”€ UIè®¾è®¡è§„èŒƒ
â”œâ”€â”€ 02_ç»„ä»¶ä½¿ç”¨/
â”‚   â”œâ”€â”€ 13ä¸ªç»„ä»¶æ–‡æ¡£
â”‚   â””â”€â”€ è¯¦ç»†APIè¯´æ˜
â””â”€â”€ 03_å¸¸è§é—®é¢˜/
    â””â”€â”€ FAQ
```

### 5.2 ç¼ºå¤±åŠŸèƒ½ (è¯„åˆ†: 0/100)

#### ğŸ”´ è®¤è¯æˆæƒç³»ç»Ÿ

**å¿…é¡»å®ç°**:

1. **ç”¨æˆ·è®¤è¯**
```typescript
// auth.module.ts
@Module({
  imports: [
    JwtModule.register({
      secret: process.env.JWT_SECRET,
      signOptions: { expiresIn: '7d' },
    }),
  ],
  controllers: [AuthController],
  providers: [AuthService, JwtStrategy],
})
export class AuthModule {}

// auth.controller.ts
@Controller('auth')
export class AuthController {
  @Post('register')
  async register(@Body() dto: RegisterDto) {}
  
  @Post('login')
  async login(@Body() dto: LoginDto) {}
  
  @Get('profile')
  @UseGuards(JwtAuthGuard)
  async getProfile(@Request() req) {}
}
```

2. **æƒé™ç®¡ç†**
```prisma
model Permission {
  id     String @id @default(uuid())
  name   String
  key    String @unique
  resource String
  action String
}

model RolePermission {
  roleId       String
  permissionId String
  @@id([roleId, permissionId])
}
```

3. **å‰ç«¯è·¯ç”±å®ˆå«**
```typescript
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  if (to.meta.requiresAuth && !token) {
    next('/login')
  } else {
    next()
  }
})
```

#### ğŸ”´ æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ

**åº”å®ç°**:
```typescript
// upload.controller.ts
@Controller('upload')
export class UploadController {
  @Post('image')
  @UseInterceptors(FileInterceptor('file'))
  async uploadImage(@UploadedFile() file: Express.Multer.File) {
    // 1. éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°
    // 2. ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
    // 3. ä¸Šä¼ åˆ°OSSæˆ–æœ¬åœ°å­˜å‚¨
    // 4. è¿”å›æ–‡ä»¶URL
  }
}
```

**é…ç½®å­˜å‚¨**:
- æœ¬åœ°å­˜å‚¨: ä½¿ç”¨`multer`
- äº‘å­˜å‚¨: é˜¿é‡Œäº‘OSS / AWS S3
- å›¾ç‰‡å¤„ç†: å‹ç¼©ã€è£å‰ªã€æ°´å°

#### ğŸ”´ æ—¥å¿—ç³»ç»Ÿ

**åº”å®ç°**:
```typescript
// æ“ä½œæ—¥å¿—
model AuditLog {
  id        String   @id @default(uuid())
  userId    String
  action    String   // 'CREATE', 'UPDATE', 'DELETE'
  resource  String   // 'USER', 'ROLE'
  resourceId String
  changes   Json?    // å˜æ›´å†…å®¹
  ip        String
  userAgent String
  createdAt DateTime @default(now())
}

// ä½¿ç”¨æ‹¦æˆªå™¨è®°å½•
@Injectable()
export class AuditInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler) {
    const request = context.switchToHttp().getRequest();
    // è®°å½•æ“ä½œæ—¥å¿—
    return next.handle();
  }
}
```

#### ğŸ”´ å…¶ä»–ç¼ºå¤±åŠŸèƒ½

1. **é‚®ä»¶æœåŠ¡**: å¯†ç é‡ç½®ã€é‚®ç®±éªŒè¯
2. **é€šçŸ¥ç³»ç»Ÿ**: ç«™å†…é€šçŸ¥ã€æ¶ˆæ¯æ¨é€
3. **æ•°æ®å¯¼å‡º**: Excel/CSVå¯¼å‡º
4. **æ•°æ®å¤‡ä»½**: å®šæ—¶å¤‡ä»½æ•°æ®åº“
5. **ç³»ç»Ÿç›‘æ§**: æ€§èƒ½ç›‘æ§ã€é”™è¯¯è¿½è¸ª
6. **å›½é™…åŒ–**: i18nå¤šè¯­è¨€æ”¯æŒ

---

## ğŸ¯ ç¬¬å…­éƒ¨åˆ†ï¼šæ”¹è¿›å»ºè®®

### 6.1 é«˜ä¼˜å…ˆçº§ (å¿…é¡»æ”¹è¿›)

#### 1. å®ç°è®¤è¯æˆæƒç³»ç»Ÿ â­â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 3-5å¤©

**å®æ–½æ­¥éª¤**:
```bash
# 1. å®‰è£…ä¾èµ–
cd apps/server
pnpm add @nestjs/jwt @nestjs/passport passport passport-jwt
pnpm add -D @types/passport-jwt

# 2. åˆ›å»ºAuthæ¨¡å—
nest g module auth
nest g service auth
nest g controller auth

# 3. å®ç°åŠŸèƒ½
- JWTç­–ç•¥
- ç™»å½•/æ³¨å†Œæ¥å£
- å¯†ç åŠ å¯†éªŒè¯
- ä»¤ç‰Œåˆ·æ–°

# 4. æ·»åŠ å®ˆå«
- JwtAuthGuard
- RolesGuard
- PermissionsGuard

# 5. å‰ç«¯é›†æˆ
- ç™»å½•é¡µé¢
- Tokenå­˜å‚¨
- è¯·æ±‚æ‹¦æˆªå™¨
- è·¯ç”±å®ˆå«
```

#### 2. æ·»åŠ è¾“å…¥éªŒè¯ â­â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 1-2å¤©

```bash
# å®‰è£…ä¾èµ–
pnpm add class-validator class-transformer

# å¯ç”¨å…¨å±€éªŒè¯
// main.ts
app.useGlobalPipes(new ValidationPipe({
  whitelist: true,
  transform: true,
  forbidNonWhitelisted: true,
}));

# ä¸ºæ‰€æœ‰DTOæ·»åŠ éªŒè¯è£…é¥°å™¨
// create-user.dto.ts
export class CreateUserDto {
  @IsEmail()
  @IsNotEmpty()
  email: string;

  @IsString()
  @MinLength(2)
  @MaxLength(50)
  name: string;

  @IsString()
  @MinLength(8)
  @Matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]/)
  password: string;
}
```

#### 3. åŠ å¼ºå®‰å…¨é…ç½® â­â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 1å¤©

```typescript
// main.ts
import helmet from 'helmet';
import { ThrottlerGuard } from '@nestjs/throttler';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  
  // å®‰å…¨å¤´
  app.use(helmet());
  
  // CORSé™åˆ¶
  app.enableCors({
    origin: process.env.FRONTEND_URL,
    credentials: true,
  });
  
  // é€Ÿç‡é™åˆ¶
  app.useGlobalGuards(new ThrottlerGuard());
  
  // CSRFä¿æŠ¤
  app.use(csurf());
  
  await app.listen(3000);
}
```

### 6.2 ä¸­ä¼˜å…ˆçº§ (å»ºè®®æ”¹è¿›)

#### 4. å®ç°ç¼“å­˜ç­–ç•¥ â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 2-3å¤©

```typescript
// ä½¿ç”¨Redisç¼“å­˜
@Injectable()
export class ConfigService {
  constructor(
    @Inject(CACHE_MANAGER) private cache: Cache,
  ) {}
  
  async getConfig(key: string) {
    const cached = await this.cache.get(`config:${key}`);
    if (cached) return cached;
    
    const config = await this.prisma.systemConfig.findUnique({ where: { key } });
    await this.cache.set(`config:${key}`, config, 3600);
    
    return config;
  }
}
```

#### 5. æ·»åŠ æ•°æ®åº“ç´¢å¼• â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 0.5å¤©

```prisma
model User {
  // ...
  @@index([email])
  @@index([roleId])
  @@index([createdAt])
  @@index([status])
}

model Role {
  // ...
  @@index([key])
}
```

#### 6. å®ç°åˆ†é¡µå’Œæ’åº â­â­â­â­

**æ—¶é—´ä¼°ç®—**: 1å¤©

```typescript
// åç«¯
@Get()
async findAll(
  @Query('page', new ParseIntPipe({ optional: true })) page = 1,
  @Query('limit', new ParseIntPipe({ optional: true })) limit = 10,
  @Query('sortBy') sortBy = 'createdAt',
  @Query('sortOrder') sortOrder: 'asc' | 'desc' = 'desc',
) {
  const skip = (page - 1) * limit;
  const [items, total] = await Promise.all([
    this.userService.findAll({ skip, take: limit, orderBy: { [sortBy]: sortOrder } }),
    this.userService.count(),
  ]);
  
  return {
    items,
    total,
    page,
    limit,
    totalPages: Math.ceil(total / limit),
  };
}
```

### 6.3 ä½ä¼˜å…ˆçº§ (ä¼˜åŒ–ä½“éªŒ)

#### 7. å‰ç«¯çŠ¶æ€ç®¡ç† â­â­â­

ä½¿ç”¨Piniaç»Ÿä¸€ç®¡ç†çŠ¶æ€

#### 8. ç»„ä»¶åº“å®Œå–„ â­â­â­

å¯¼å‡ºæ‰€æœ‰ç»„ä»¶ï¼Œæ·»åŠ å•å…ƒæµ‹è¯•

#### 9. æ€§èƒ½ç›‘æ§ â­â­

é›†æˆæ€§èƒ½ç›‘æ§å·¥å…·

#### 10. å›½é™…åŒ– â­â­

æ·»åŠ å¤šè¯­è¨€æ”¯æŒ

---

## ğŸ“Š ç¬¬ä¸ƒéƒ¨åˆ†ï¼šåŠŸèƒ½æ‰©å±•å»ºè®®

### 7.1 æ¨èæ–°å¢åŠŸèƒ½æ¨¡å—

#### 1. å†…å®¹ç®¡ç†ç³»ç»Ÿ (CMS)

**é€‚ç”¨åœºæ™¯**: å®˜ç½‘å†…å®¹ã€å…¬å‘Šã€æ–°é—»

```prisma
model Article {
  id          String   @id @default(uuid())
  title       String
  content     String   @db.Text
  cover       String?
  categoryId  String
  category    Category @relation(...)
  authorId    String
  author      User     @relation(...)
  status      String   // draft, published, archived
  publishedAt DateTime?
  createdAt   DateTime @default(now())
  
  @@index([categoryId])
  @@index([authorId])
  @@index([status])
}

model Category {
  id       String    @id @default(uuid())
  name     String
  slug     String    @unique
  articles Article[]
}
```

#### 2. å·¥ä½œæµå¼•æ“

**é€‚ç”¨åœºæ™¯**: å®¡æ‰¹æµç¨‹ã€ä»»åŠ¡ç®¡ç†

```prisma
model Workflow {
  id          String   @id @default(uuid())
  name        String
  description String?
  steps       Json     // å·¥ä½œæµæ­¥éª¤é…ç½®
  isActive    Boolean  @default(true)
}

model WorkflowInstance {
  id         String   @id @default(uuid())
  workflowId String
  workflow   Workflow @relation(...)
  status     String   // pending, approved, rejected
  currentStep Int
  data       Json     // æµç¨‹æ•°æ®
  createdBy  String
  createdAt  DateTime @default(now())
}
```

#### 3. æ•°æ®åˆ†æé¢æ¿

**é€‚ç”¨åœºæ™¯**: ç”¨æˆ·è¡Œä¸ºåˆ†æã€ç³»ç»Ÿç›‘æ§

**åŠŸèƒ½**:
- ç”¨æˆ·æ´»è·ƒåº¦ç»Ÿè®¡
- APIè°ƒç”¨æ¬¡æ•°
- é”™è¯¯ç‡ç›‘æ§
- æ€§èƒ½æŒ‡æ ‡

#### 4. æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ

**é€‚ç”¨åœºæ™¯**: å¼‚æ­¥ä»»åŠ¡ã€é‚®ä»¶å‘é€

```typescript
// ä½¿ç”¨Bull
@Injectable()
export class EmailService {
  constructor(
    @InjectQueue('email') private emailQueue: Queue,
  ) {}
  
  async sendWelcomeEmail(user: User) {
    await this.emailQueue.add('welcome', {
      userId: user.id,
      email: user.email,
    });
  }
}
```

#### 5. æœç´¢ç³»ç»Ÿ

**é€‚ç”¨åœºæ™¯**: å…¨æ–‡æœç´¢ã€æ™ºèƒ½æ¨è

**é€‰æ‹©**:
- PostgreSQL å…¨æ–‡æœç´¢
- Elasticsearch
- MeiliSearch (è½»é‡çº§)

```typescript
// ä½¿ç”¨PostgreSQLå…¨æ–‡æœç´¢
@Get('search')
async search(@Query('q') query: string) {
  return this.prisma.$queryRaw`
    SELECT * FROM "User"
    WHERE to_tsvector('simple', name || ' ' || email) 
    @@ to_tsquery('simple', ${query})
  `;
}
```

### 7.2 AIåŠŸèƒ½é›†æˆ

#### 1. AIå‘é‡æœç´¢

**å·²å‡†å¤‡**: pgvectoræ‰©å±•å·²å®‰è£…

```prisma
model Document {
  id        String                 @id @default(uuid())
  content   String
  embedding Unsupported("vector")?
  
  @@index([embedding])
}
```

**å®ç°ç›¸ä¼¼åº¦æœç´¢**:
```typescript
async findSimilar(queryEmbedding: number[]) {
  return this.prisma.$queryRaw`
    SELECT *, 
      embedding <-> ${queryEmbedding}::vector AS distance
    FROM "Document"
    ORDER BY distance
    LIMIT 10
  `;
}
```

#### 2. AIå¯¹è¯åŠ©æ‰‹

**åŠŸèƒ½**:
- é›†æˆOpenAI API
- ä¸Šä¸‹æ–‡ç®¡ç†
- æµå¼å“åº”

#### 3. æ™ºèƒ½æ¨è

**åŠŸèƒ½**:
- åŸºäºç”¨æˆ·è¡Œä¸ºæ¨èå†…å®¹
- ååŒè¿‡æ»¤ç®—æ³•

---

## ğŸ“ˆ ç¬¬å…«éƒ¨åˆ†ï¼šæŠ€æœ¯å€ºåŠ¡æ¸…å•

### 8.1 ä»£ç å±‚é¢

| é—®é¢˜ | å½±å“ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ |
|------|------|--------|--------|
| RichTextEditor.vueè¶…è¿‡900è¡Œ | å¯ç»´æŠ¤æ€§ | ä¸­ | 1å¤© |
| æœªä½¿ç”¨PiniaçŠ¶æ€ç®¡ç† | çŠ¶æ€æ··ä¹± | ä¸­ | 1å¤© |
| APIæ··ç”¨axioså’Œfetch | ä¸ä¸€è‡´ | ä½ | 0.5å¤© |
| ç»„ä»¶æœªç»Ÿä¸€å¯¼å‡º | å¤ç”¨æ€§å·® | ä½ | 0.5å¤© |
| ç¼ºå°‘TypeScriptä¸¥æ ¼æ¨¡å¼ | ç±»å‹å®‰å…¨ | ä¸­ | 1å¤© |

### 8.2 æ¶æ„å±‚é¢

| é—®é¢˜ | å½±å“ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ |
|------|------|--------|--------|
| æ— è®¤è¯æˆæƒç³»ç»Ÿ | å®‰å…¨æ€§ | é«˜ | 5å¤© |
| æ— è¾“å…¥éªŒè¯ | å®‰å…¨æ€§ | é«˜ | 2å¤© |
| æ— ç¼“å­˜ç­–ç•¥ | æ€§èƒ½ | ä¸­ | 3å¤© |
| Redisæœªä½¿ç”¨ | èµ„æºæµªè´¹ | ä½ | 2å¤© |
| æ— æ—¥å¿—ç³»ç»Ÿ | å¯è§‚æµ‹æ€§ | ä¸­ | 3å¤© |

### 8.3 æµ‹è¯•è¦†ç›–

ğŸ”´ **å®Œå…¨ç¼ºå¤±æµ‹è¯•**
- æ— å•å…ƒæµ‹è¯•
- æ— é›†æˆæµ‹è¯•
- æ— E2Eæµ‹è¯•

**å»ºè®®**:
```bash
# å‰ç«¯æµ‹è¯•
pnpm add -D vitest @vue/test-utils

# åç«¯æµ‹è¯•
pnpm add -D @nestjs/testing jest

# E2Eæµ‹è¯•
pnpm add -D cypress playwright
```

---

## ğŸ¯ ç¬¬ä¹éƒ¨åˆ†ï¼šå®æ–½è·¯çº¿å›¾

### Phase 1: å®‰å…¨åŠ å›º (1-2å‘¨)

**ç›®æ ‡**: ä¿®å¤æ‰€æœ‰å®‰å…¨é—®é¢˜

- [ ] å®ç°JWTè®¤è¯ (5å¤©)
  - ç™»å½•/æ³¨å†Œæ¥å£
  - JWTç”Ÿæˆå’ŒéªŒè¯
  - å‰ç«¯Tokenç®¡ç†
  
- [ ] æ·»åŠ è¾“å…¥éªŒè¯ (2å¤©)
  - DTOéªŒè¯è£…é¥°å™¨
  - å…¨å±€éªŒè¯ç®¡é“
  - é”™è¯¯å¤„ç†

- [ ] åŠ å¼ºå®‰å…¨é…ç½® (1å¤©)
  - Helmetå®‰å…¨å¤´
  - CORSé™åˆ¶
  - é€Ÿç‡é™åˆ¶

- [ ] å¯†ç å®‰å…¨ (1å¤©)
  - æé«˜bcryptè½®æ•°
  - å¯†ç å¤æ‚åº¦éªŒè¯
  - å¯†ç é‡ç½®åŠŸèƒ½

### Phase 2: åŠŸèƒ½å®Œå–„ (2-3å‘¨)

**ç›®æ ‡**: è¡¥é½æ ¸å¿ƒåŠŸèƒ½

- [ ] æƒé™ç®¡ç† (5å¤©)
  - Permissionè¡¨è®¾è®¡
  - RBACå®ç°
  - å‰ç«¯æƒé™æ§åˆ¶

- [ ] æ–‡ä»¶ä¸Šä¼  (3å¤©)
  - å›¾ç‰‡ä¸Šä¼ æ¥å£
  - OSSé›†æˆ
  - æ–‡ä»¶ç®¡ç†

- [ ] æ—¥å¿—ç³»ç»Ÿ (3å¤©)
  - æ“ä½œæ—¥å¿—
  - é”™è¯¯æ—¥å¿—
  - è®¿é—®æ—¥å¿—

- [ ] åˆ†é¡µæ’åº (2å¤©)
  - åç«¯åˆ†é¡µ
  - å‰ç«¯åˆ†é¡µç»„ä»¶
  - æ’åºåŠŸèƒ½

### Phase 3: æ€§èƒ½ä¼˜åŒ– (1-2å‘¨)

**ç›®æ ‡**: æå‡ç³»ç»Ÿæ€§èƒ½

- [ ] ç¼“å­˜å®ç° (3å¤©)
  - Redisé›†æˆ
  - é…ç½®ç¼“å­˜
  - æŸ¥è¯¢ç¼“å­˜

- [ ] æ•°æ®åº“ä¼˜åŒ– (2å¤©)
  - æ·»åŠ ç´¢å¼•
  - æŸ¥è¯¢ä¼˜åŒ–
  - è¿æ¥æ± é…ç½®

- [ ] å‰ç«¯ä¼˜åŒ– (3å¤©)
  - ä»£ç åˆ†å‰²
  - æ‡’åŠ è½½
  - ç»„ä»¶æ€§èƒ½ä¼˜åŒ–

### Phase 4: æ‰©å±•åŠŸèƒ½ (æŒ‰éœ€)

**ç›®æ ‡**: æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ‰©å±•

- [ ] CMSç³»ç»Ÿ
- [ ] å·¥ä½œæµå¼•æ“
- [ ] æ•°æ®åˆ†æ
- [ ] AIåŠŸèƒ½é›†æˆ

---

## ğŸ“ ç¬¬åéƒ¨åˆ†ï¼šç»“è®ºä¸å»ºè®®

### 10.1 æ€»ä½“è¯„ä»·

DongUI v1.0 æ˜¯ä¸€ä¸ª**æœ‰æ½œåŠ›**çš„å…¨æ ˆè„šæ‰‹æ¶é¡¹ç›®ï¼Œåœ¨ä¸»é¢˜ç³»ç»Ÿå’ŒUIè®¾è®¡ä¸Šè¡¨ç°å‡ºè‰²ï¼Œä½†åœ¨å®‰å…¨æ€§å’ŒåŠŸèƒ½å®Œæ•´æ€§æ–¹é¢å­˜åœ¨æ˜æ˜¾ä¸è¶³ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**:
1. âœ… åˆ›æ–°çš„åŠ¨æ€ä¸»é¢˜ç³»ç»Ÿï¼ŒçœŸæ­£å®ç°äº†å…¨å±€UIæ§åˆ¶
2. âœ… å®Œå–„çš„æ–‡æ¡£ç³»ç»Ÿï¼Œé™ä½äº†å­¦ä¹ æˆæœ¬
3. âœ… æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
4. âœ… ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆï¼Œæ€§èƒ½å’Œå¼€å‘ä½“éªŒè‰¯å¥½

**æ ¸å¿ƒé—®é¢˜**:
1. âŒ å®Œå…¨ç¼ºå¤±è®¤è¯æˆæƒï¼Œæ— æ³•ç”¨äºç”Ÿäº§ç¯å¢ƒ
2. âŒ å®‰å…¨é…ç½®ä¸è¶³ï¼Œå­˜åœ¨å¤šä¸ªå®‰å…¨æ¼æ´
3. âŒ åŠŸèƒ½ä¸å®Œæ•´ï¼Œç¼ºå°‘å…³é”®ä¸šåŠ¡åŠŸèƒ½
4. âŒ æ— æµ‹è¯•è¦†ç›–ï¼Œä»£ç è´¨é‡æ— ä¿éšœ

### 10.2 é€‚ç”¨åœºæ™¯

**å½“å‰é€‚åˆ**:
- ä¸ªäººé¡¹ç›®å¿«é€Ÿæ­å»º
- å­¦ä¹ å…¨æ ˆå¼€å‘
- UIä¸»é¢˜ç³»ç»Ÿç ”ç©¶
- åŸå‹å¼€å‘

**ä¸é€‚åˆ**:
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- ä¼ä¸šçº§åº”ç”¨
- å®‰å…¨è¦æ±‚é«˜çš„é¡¹ç›®
- é«˜å¹¶å‘åœºæ™¯

### 10.3 å…³é”®å»ºè®®

#### ç»™å¼€å‘è€…çš„å»ºè®®

1. **ç«‹å³ä¿®å¤å®‰å…¨é—®é¢˜** â­â­â­â­â­
   - è¿™æ˜¯ç”Ÿäº§å°±ç»ªçš„å…ˆå†³æ¡ä»¶
   - æŠ•å…¥1-2å‘¨å®Œæˆå®‰å…¨åŠ å›º
   
2. **å®Œå–„è®¤è¯æˆæƒ** â­â­â­â­â­
   - å®ç°JWTè®¤è¯
   - æ·»åŠ æƒé™æ§åˆ¶
   - ä¿æŠ¤æ‰€æœ‰API

3. **æ·»åŠ æµ‹è¯•** â­â­â­â­
   - è‡³å°‘50%çš„ä»£ç è¦†ç›–ç‡
   - å…³é”®åŠŸèƒ½100%è¦†ç›–

4. **æ€§èƒ½ä¼˜åŒ–** â­â­â­
   - å®ç°Redisç¼“å­˜
   - æ·»åŠ æ•°æ®åº“ç´¢å¼•
   - ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

#### ç»™ä½¿ç”¨è€…çš„å»ºè®®

1. **ä¸è¦ç›´æ¥ç”¨äºç”Ÿäº§**
   - å¿…é¡»å…ˆå®Œæˆå®‰å…¨åŠ å›º
   - æ·»åŠ å¿…è¦çš„ä¸šåŠ¡åŠŸèƒ½

2. **å¯ç”¨äºå­¦ä¹ å’ŒåŸå‹**
   - ä¸»é¢˜ç³»ç»Ÿå€¼å¾—å­¦ä¹ 
   - ä»£ç ç»“æ„æ¸…æ™°æ˜“æ‡‚

3. **å®šåˆ¶åŒ–å¼€å‘**
   - æ ¹æ®ä¸šåŠ¡éœ€æ±‚è£å‰ªåŠŸèƒ½
   - æ·»åŠ ç‰¹å®šä¸šåŠ¡æ¨¡å—

### 10.4 æœªæ¥å±•æœ›

å¦‚æœæŒ‰ç…§æœ¬æŠ¥å‘Šçš„å»ºè®®è¿›è¡Œæ”¹è¿›ï¼ŒDongUIæœ‰æ½œåŠ›æˆä¸ºï¼š

1. **ä¼˜ç§€çš„ä¼ä¸šçº§è„šæ‰‹æ¶**
   - å®Œå–„çš„å®‰å…¨æœºåˆ¶
   - ä¸°å¯Œçš„åŠŸèƒ½æ¨¡å—
   - é«˜æ€§èƒ½æ¶æ„

2. **ä¸»é¢˜ç³»ç»Ÿæ ‡æ†**
   - ç‹¬ç‰¹çš„åŠ¨æ€åŒ–UIæ–¹æ¡ˆ
   - å¯å¤ç”¨çš„ç»„ä»¶åº“
   - å®Œæ•´çš„é…ç½®ç®¡ç†

3. **å…¨æ ˆå­¦ä¹ èµ„æº**
   - å®Œå–„çš„æ–‡æ¡£
   - æœ€ä½³å®è·µç¤ºä¾‹
   - æ´»è·ƒçš„ç¤¾åŒº

---

## ğŸ“š é™„å½•

### A. æ¨èä¾èµ–åŒ…

#### åç«¯
```json
{
  "å¿…é¡»æ·»åŠ ": {
    "@nestjs/jwt": "^10.1.0",
    "@nestjs/passport": "^10.0.0",
    "passport-jwt": "^4.0.1",
    "class-validator": "^0.14.0",
    "class-transformer": "^0.5.1",
    "helmet": "^7.0.0",
    "@nestjs/throttler": "^5.0.0"
  },
  "å»ºè®®æ·»åŠ ": {
    "cache-manager": "^5.2.3",
    "cache-manager-redis-store": "^3.0.1",
    "winston": "^3.10.0",
    "@nestjs/bull": "^10.0.1",
    "bull": "^4.11.3",
    "multer": "^1.4.5-lts.1"
  }
}
```

#### å‰ç«¯
```json
{
  "å»ºè®®æ·»åŠ ": {
    "pinia": "^2.1.6",
    "@vueuse/core": "^10.4.1",
    "vee-validate": "^4.11.8",
    "yup": "^1.3.2"
  },
  "æµ‹è¯•ç›¸å…³": {
    "vitest": "^0.34.6",
    "@vue/test-utils": "^2.4.1",
    "cypress": "^13.3.0"
  }
}
```

### B. å‚è€ƒèµ„æº

1. **å®‰å…¨æœ€ä½³å®è·µ**
   - OWASP Top 10
   - NestJS Security Documentation
   - JWT Best Current Practices

2. **æ€§èƒ½ä¼˜åŒ–**
   - Web Vitals
   - Lighthouse Performance
   - Database Indexing Strategies

3. **æ¶æ„è®¾è®¡**
   - Clean Architecture
   - Domain-Driven Design
   - Microservices Patterns

### C. æ£€æŸ¥æ¸…å•

#### ä¸Šçº¿å‰å¿…é¡»å®Œæˆ

- [ ] å®ç°å®Œæ•´çš„è®¤è¯æˆæƒ
- [ ] æ·»åŠ è¾“å…¥éªŒè¯
- [ ] ä¿®å¤æ‰€æœ‰å®‰å…¨é…ç½®
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- [ ] å®ç°æ•°æ®åº“å¤‡ä»½
- [ ] æ·»åŠ ç›‘æ§å‘Šè­¦
- [ ] ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- [ ] è¿›è¡Œå®‰å…¨å®¡è®¡
- [ ] æ€§èƒ½å‹åŠ›æµ‹è¯•
- [ ] å‡†å¤‡éƒ¨ç½²æ–‡æ¡£

---

**æŠ¥å‘Šç»“æŸ**

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„æŠ€æœ¯æ”¯æŒï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- GitHub Issues: https://github.com/donhauser001/DongUIv1.0/issues
- Email: donhauser001@gmail.com

**å®¡è®¡å›¢é˜Ÿ**  
2024å¹´11æœˆ24æ—¥

